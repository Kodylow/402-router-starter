import{Value as r}from"@sinclair/typebox/value";import{StatusMap as e}from"./utils";let t="undefined"!=typeof Bun?Bun.env:"undefined"!=typeof process?process?.env:void 0;export const ERROR_CODE=Symbol("ElysiaErrorCode");export const ELYSIA_RESPONSE=Symbol("ElysiaResponse");export const isProduction=(t?.NODE_ENV??t?.ENV)==="production";export const error=(r,t)=>({[ELYSIA_RESPONSE]:e[r]??r,response:t});export class InternalServerError extends Error{code="INTERNAL_SERVER_ERROR";status=500;constructor(r){super(r??"INTERNAL_SERVER_ERROR")}}export class NotFoundError extends Error{code="NOT_FOUND";status=404;constructor(r){super(r??"NOT_FOUND")}}export class ParseError extends Error{code="PARSE";status=400;constructor(r){super(r??"PARSE")}}export class InvalidCookieSignature extends Error{key;code;status;constructor(r,e){super(e??`"${r}" has invalid cookie signature`),this.key=r,this.code="INVALID_COOKIE_SIGNATURE",this.status=400}}export class ValidationError extends Error{type;validator;value;code;status;constructor(e,t,s){let o=isProduction?void 0:"Errors"in t?t.Errors(s).First():r.Errors(t,s).First(),i=o?.schema.error?"function"==typeof o.schema.error?o.schema.error(e,t,s):o.schema.error:void 0,a=o?.path?.slice(1)||"root";super(i?"object"==typeof i?JSON.stringify(i):i+"":isProduction?JSON.stringify({type:e,message:o?.message}):JSON.stringify({type:e,at:a,message:o?.message,expected:r.Create(t.schema),found:s,errors:[...t.Errors(s)]},null,2)),this.type=e,this.validator=t,this.value=s,this.code="VALIDATION",this.status=400,Object.setPrototypeOf(this,ValidationError.prototype)}get all(){return[...this.validator.Errors(this.value)]}static simplifyModel(e){let t="schema"in e?e.schema:e;try{return r.Create(t)}catch{return t}}get model(){return ValidationError.simplifyModel(this.validator)}toResponse(r){return new Response(this.message,{status:400,headers:r})}}